# ===============================================================================
# 知识库问答系统 - 环境变量配置示例
# ===============================================================================
# 此文件包含了系统运行所需的所有环境变量配置
# 请将此文件复制为 .env 并根据实际环境修改配置值
# ===============================================================================

# ===============================================================================
# 配置管理设置
# ===============================================================================

# 配置管理模式 (standard/minimal/custom)
CONFIG_MODE=standard

# 配置文件版本 (用于环境管理脚本)
CONFIG_VERSION=1.0.0

# 配置缓存TTL (秒)
CONFIG_CACHE_TTL=300

# 配置验证开关
CONFIG_VALIDATION_ENABLED=true

# 动态配置注入开关
DYNAMIC_CONFIG_INJECTION_ENABLED=true

# 热重载配置开关 (仅开发环境建议启用)
HOT_RELOAD_CONFIG_ENABLED=false

# 配置变更通知开关
CONFIG_CHANGE_NOTIFICATIONS_ENABLED=true

# ===============================================================================
# 系统基础配置
# ===============================================================================

# 应用环境 (development/testing/staging/production/minimal)
APP_ENV=development

# 服务配置 (必需)
SERVICE_NAME=知识库问答系统
SERVICE_IP=127.0.0.1
SERVICE_PORT=8000

# 基础URL配置
BASE_URL=http://127.0.0.1:8000

# 调试模式
DEBUG_MODE=true

# 允许访问的域名
ALLOWED_HOSTS=["localhost", "127.0.0.1", "*"]

# CORS跨域配置
CORS_ENABLED=true
CORS_ORIGINS=["http://localhost:3000", "http://127.0.0.1:3000", "http://localhost:8000", "http://127.0.0.1:8000"]
CORS_ALLOW_CREDENTIALS=true

# 请求限制配置
REQUEST_LIMITING_ENABLED=true
REQUEST_RATE_LIMIT=60

# ===============================================================================
# 安全配置 (必需)
# ===============================================================================

# JWT配置 (必需) - 生产环境请使用随机生成的密钥
JWT_SECRET_KEY=your-secret-jwt-key-here-change-in-production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# 配置数据加密密钥 (建议设置)
ENCRYPTION_KEY=your-encryption-key-here-change-in-production

# ===============================================================================
# 数据库配置 (必需)
# ===============================================================================

# PostgreSQL配置 (必需)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=knowledge_qa

# 数据库连接URL (必需)
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/knowledge_qa

# ===============================================================================
# 服务配置
# ===============================================================================

# Redis配置 (必需)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# MinIO存储配置 (必需)
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_SECURE=false
MINIO_BUCKET=knowledge-docs

# Milvus向量数据库配置 (必需)
MILVUS_HOST=localhost
MILVUS_PORT=19530
MILVUS_COLLECTION=document_vectors

# Elasticsearch配置 (必需)
ELASTICSEARCH_URL=http://localhost:9200
ELASTICSEARCH_USERNAME=
ELASTICSEARCH_PASSWORD=
ELASTICSEARCH_INDEX=document_index
ELASTICSEARCH_DEFAULT_ANALYZER=standard
ELASTICSEARCH_EMBEDDING_DIM=1536
ELASTICSEARCH_SIMILARITY=cosine
ELASTICSEARCH_HYBRID_SEARCH=true
ELASTICSEARCH_HYBRID_WEIGHT=0.5

# RabbitMQ配置
RABBITMQ_HOST=localhost
RABBITMQ_PORT=5672
RABBITMQ_USER=guest
RABBITMQ_PASSWORD=guest

# Nacos配置中心
NACOS_SERVER_ADDRESSES=127.0.0.1:8848
NACOS_NAMESPACE=public
NACOS_GROUP=DEFAULT_GROUP

# Celery异步任务
CELERY_BROKER_URL=amqp://guest:guest@localhost:5672//
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# Celery高级配置
CELERY_BEAT_SCHEDULE_FILENAME=celerybeat-schedule
CELERY_TIMEZONE=Asia/Shanghai
CELERY_WORKER_PREFETCH_MULTIPLIER=1
CELERY_TASK_ACKS_LATE=true
CELERY_TASK_REJECT_ON_WORKER_LOST=true
CELERY_WORKER_CANCEL_LONG_RUNNING_TASKS_ON_CONNECTION_LOSS=true

# Flower监控配置
FLOWER_PORT=5555
FLOWER_BASIC_AUTH=admin:password
FLOWER_URL_PREFIX=/flower
FLOWER_ENABLE_EVENTS=true

# 邮件配置（用于系统通知）
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USE_TLS=true
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-password
EMAIL_FROM=system@yourcompany.com

# 告警配置
ALERT_EMAIL_RECIPIENTS=admin@yourcompany.com,ops@yourcompany.com
ALERT_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
ALERT_CPU_THRESHOLD=80
ALERT_MEMORY_THRESHOLD=85
ALERT_DISK_THRESHOLD=90

# 系统维护配置
CLEANUP_TEMP_FILES_DAYS=1
CLEANUP_TASK_HISTORY_DAYS=30
CLEANUP_LOG_FILES_DAYS=30
SYSTEM_HEALTH_CHECK_INTERVAL=300
DISK_SPACE_CHECK_INTERVAL=3600

# InfluxDB时序数据库
INFLUXDB_URL=http://localhost:8086
INFLUXDB_TOKEN=your-influxdb-token
INFLUXDB_ORG=your-org
INFLUXDB_BUCKET=knowledge-qa

# ===============================================================================
# 模型配置
# ===============================================================================

# 基础模型配置 (至少需要配置一个模型提供商)
DEFAULT_MODEL=gpt-4
EMBEDDING_MODEL=text-embedding-ada-002
CHAT_MODEL=gpt-3.5-turbo

# OpenAI配置 (第三方API提供商之一)
OPENAI_API_KEY=your-openai-api-key
OPENAI_API_BASE=https://api.openai.com/v1
OPENAI_ORGANIZATION=your-openai-org-id

# 智谱AI配置 (可选的第三方提供商)
ZHIPU_API_KEY=your-zhipu-api-key

# GLM配置 (可选的第三方提供商)
GLM_API_KEY=your-glm-api-key
GLM_API_BASE=https://open.bigmodel.cn/api/paas/v4

# 百度文心一言配置 (可选的第三方提供商)
BAIDU_API_KEY=your-baidu-api-key
BAIDU_SECRET_KEY=your-baidu-secret-key
BAIDU_API_BASE=https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop

# 月之暗面配置 (可选的第三方提供商)
MOONSHOT_API_KEY=your-moonshot-api-key
MOONSHOT_API_BASE=https://api.moonshot.cn/v1

# MiniMax配置 (可选的第三方提供商)
MINIMAX_API_KEY=your-minimax-api-key
MINIMAX_GROUP_ID=your-minimax-group-id
MINIMAX_API_BASE=https://api.minimax.chat/v1

# DashScope通义千问配置 (可选的第三方提供商)
DASHSCOPE_API_KEY=your-dashscope-api-key
QWEN_API_KEY=your-qwen-api-key
QWEN_API_BASE=https://dashscope.aliyuncs.com/api/v1

# 百川配置 (可选的第三方提供商)
BAICHUAN_API_KEY=your-baichuan-api-key
BAICHUAN_SECRET_KEY=your-baichuan-secret-key
BAICHUAN_API_BASE=https://api.baichuan-ai.com/v1

# DeepSeek配置 (可选的第三方提供商)
DEEPSEEK_API_KEY=your-deepseek-api-key
DEEPSEEK_API_BASE=https://api.deepseek.com/v1

# Anthropic配置 (可选的第三方提供商)
ANTHROPIC_API_KEY=your-anthropic-api-key
ANTHROPIC_API_BASE=https://api.anthropic.com

# Together AI配置 (可选的第三方提供商)
TOGETHER_API_KEY=your-together-api-key
TOGETHER_API_BASE=https://api.together.xyz/v1

# 本地模型配置 (与第三方API不冲突，可同时配置)
OLLAMA_API_BASE=http://localhost:11434
VLLM_API_BASE=http://localhost:8000

# 重排序配置 (条件必需：启用时必须配置模型)
RERRANK_ENABLED=false
DEFAULT_RERANK_MODEL=cross-encoder/ms-marco-MiniLM-L-6-v2

# ===============================================================================
# 功能配置
# ===============================================================================

# 文档处理配置
DOCUMENT_CHUNK_SIZE=1000
DOCUMENT_CHUNK_OVERLAP=200
DOCUMENT_MAX_FILE_SIZE_MB=100
DOCUMENT_SPLITTER_TYPE=sentence
DOCUMENT_PROCESSING_CONCURRENCY=4
DOCUMENT_PROCESSING_TIMEOUT=3600
DOCUMENT_SEMANTIC_CHUNK_STRATEGY=auto
DOCUMENT_USE_METADATA_EXTRACTION=true

# 功能开关
VOICE_ENABLED=false
METRICS_ENABLED=true
OWL_TOOLS_ENABLED=false
LIGHTRAG_ENABLED=false
SEARXNG_ENABLED=false
ADVANCED_TOOLS_ENABLED=false

# 语音配置
STT_MODEL_NAME=xunfei-stt
TTS_MODEL_NAME=xunfei-tts

# ===============================================================================
# 日志配置
# ===============================================================================

LOG_LEVEL=INFO
LOG_FORMAT=detailed
LOG_CONSOLE_ENABLED=true
LOG_FILE_ENABLED=true
LOG_FILE_PATH=./logs/app.log

# ===============================================================================
# LightRAG知识图谱配置
# ===============================================================================

LIGHTRAG_BASE_DIR=./data/lightrag
LIGHTRAG_EMBEDDING_DIM=1536
LIGHTRAG_MAX_TOKEN_SIZE=8192
LIGHTRAG_GRAPH_DB_TYPE=file
LIGHTRAG_USE_SEMANTIC_CHUNKING=false
LIGHTRAG_USE_KNOWLEDGE_GRAPH=false
LIGHTRAG_KG_RELATION_THRESHOLD=0.7
LIGHTRAG_MAX_WORKERS=4

# ===============================================================================
# SearxNG搜索引擎配置
# ===============================================================================

SEARXNG_AUTO_DEPLOY=false
SEARXNG_HOST=localhost
SEARXNG_PORT=8080
SEARXNG_DOCKER_IMAGE=searxng/searxng:latest
SEARXNG_CONTAINER_NAME=searxng
SEARXNG_BIND_PORT=8080
SEARXNG_INSTANCE_NAME=知识库搜索
SEARXNG_BASE_URL=http://localhost:8080
SEARXNG_BIND_ADDRESS=0.0.0.0

# ===============================================================================
# 敏感词过滤配置
# ===============================================================================

SENSITIVE_WORD_FILTER_TYPE=local
SENSITIVE_WORD_FILTER_RESPONSE=很抱歉，您的消息包含敏感内容，请调整后重新发送。
SENSITIVE_WORD_DICT_PATH=
SENSITIVE_WORD_API_URL=
SENSITIVE_WORD_API_KEY=
SENSITIVE_WORD_API_TIMEOUT=3.0
SENSITIVE_WORD_CACHE_ENABLED=true
SENSITIVE_WORD_CACHE_TTL=3600

# ===============================================================================
# 扩展AI模型提供商配置
# ===============================================================================

# 阿里云语音服务
ALIYUN_ACCESS_KEY_ID=your-aliyun-access-key-id
ALIYUN_ACCESS_KEY_SECRET=your-aliyun-access-key-secret
ALIYUN_SPEECH_APPKEY=your-aliyun-speech-appkey

# 讯飞语音服务
XUNFEI_APP_ID=your-xunfei-app-id
XUNFEI_API_KEY=your-xunfei-api-key
XUNFEI_API_SECRET=your-xunfei-api-secret

# 语音功能详细配置
STT_LANGUAGE=zh-CN
STT_SAMPLING_RATE=16000
TTS_VOICE=xiaoyan
TTS_SPEED=50
TTS_AUDIO_FORMAT=mp3

# ===============================================================================
# 框架配置
# ===============================================================================

# 统一入口配置
FRAMEWORK_ENTRY_POINT=llamaindex

# QA助手框架配置
QA_ASSISTANT_FRAMEWORK=agno
QA_RETRIEVER_FRAMEWORK=haystack
QA_INDEXER_FRAMEWORK=llamaindex

# QA管理框架配置
QA_MANAGEMENT_CONVERSATION_FRAMEWORK=llamaindex
QA_MANAGEMENT_MEMORY_FRAMEWORK=agno
QA_MANAGEMENT_API_FRAMEWORK=llamaindex

# 知识库管理框架配置
KNOWLEDGE_MANAGEMENT_INDEXING_FRAMEWORK=llamaindex
KNOWLEDGE_MANAGEMENT_SEARCH_FRAMEWORK=haystack

# 内存配置
MEMORY_TYPE=conversation_buffer
MEMORY_K=5

# LlamaIndex配置
LLAMAINDEX_CHUNK_SIZE=1000
LLAMAINDEX_CHUNK_OVERLAP=200
LLAMAINDEX_EMBEDDING_MODEL=text-embedding-ada-002
LLAMAINDEX_LLM_MODEL=gpt-3.5-turbo
LLAMAINDEX_INDEX_TYPE=vector_store
LLAMAINDEX_USE_KNOWLEDGE_GRAPH=false
LLAMAINDEX_DEFAULT_STORE=elasticsearch

# Haystack配置
HAYSTACK_READER_MODEL=deepset/roberta-base-squad2
HAYSTACK_RETRIEVER_TYPE=embedding
HAYSTACK_USE_BM25=true
HAYSTACK_TOP_K=5
HAYSTACK_EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
HAYSTACK_RERANK_DOCUMENTS=false
HAYSTACK_RERANKER_MODEL=cross-encoder/ms-marco-MiniLM-L-6-v2

# Agno配置
AGNO_AGENT_TYPE=conversational
AGNO_MODEL=gpt-3.5-turbo
AGNO_MAX_ITERATIONS=5
AGNO_MEMORY_TYPE=conversation_buffer
AGNO_MEMORY_K=5

# ===============================================================================
# 遗留配置 (向后兼容)
# ===============================================================================

# 遗留路径配置
VECTOR_STORE_PATH=./vector_store
KNOWLEDGE_BASE_PATH=./knowledge_base

# LangChain配置 (已弃用，保留兼容性)
LANGCHAIN_EMBEDDING_MODEL=text-embedding-ada-002
LANGCHAIN_CHAT_MODEL=gpt-3.5-turbo
LANGCHAIN_MEMORY_TYPE=conversation_buffer
LANGCHAIN_MEMORY_K=5
LANGCHAIN_USE_LANGSMITH=false
LANGCHAIN_LANGSMITH_API_KEY=
LANGCHAIN_LANGSMITH_PROJECT=knowledge-qa

# ===============================================================================
# 生产环境安全提示
# ===============================================================================
# 
# 🔒 生产环境部署前请务必：
# 1. 修改所有默认密码和密钥
# 2. 使用强随机密钥替换示例密钥
# 3. 启用HTTPS和适当的防火墙规则
# 4. 定期轮换API密钥和访问凭证
# 5. 审查并限制跨域访问配置
# 
# ===============================================================================
